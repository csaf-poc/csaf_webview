import{s as j,c as ue,u as ae,g as ce,d as de,f as C,n as H,e as fe}from"./scheduler.8b5db029.js";import{S as q,i as X,g as T,s as V,h as b,j as R,c as G,f as E,l as L,k as _,B as W,a as N,y as v,d as he,t as _e,m as F,n as M,z as Y,o as U,e as K,A as Ee,x as ge}from"./index.0646f6aa.js";import{a as m}from"./store.8eeb1325.js";import{h as me}from"./singletons.25a4a116.js";function z(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function J(e){let t,r,s,n,i,l,c,a;return{c(){t=T("div"),r=T("h2"),s=T("i"),i=F(e[0]),this.h()},l(o){t=b(o,"DIV",{style:!0,id:!0,class:!0});var u=R(t);r=b(u,"H2",{class:!0});var d=R(r);s=b(d,"I",{class:!0}),R(s).forEach(E),i=M(d,e[0]),d.forEach(E),u.forEach(E),this.h()},h(){_(s,"class",n="bx "+e[5]+" svelte-1bnrt9"),_(r,"class","svelte-1bnrt9"),L(t,"cursor","pointer"),_(t,"id",e[0]),_(t,"class",l=C(e[2])+" svelte-1bnrt9")},m(o,u){N(o,t,u),v(t,r),v(r,s),v(r,i),c||(a=Y(t,"click",e[6]),c=!0)},p(o,u){u&32&&n!==(n="bx "+o[5]+" svelte-1bnrt9")&&_(s,"class",n),u&1&&U(i,o[0]),u&1&&_(t,"id",o[0]),u&4&&l!==(l=C(o[2])+" svelte-1bnrt9")&&_(t,"class",l)},d(o){o&&E(t),c=!1,a()}}}function Q(e){let t,r,s,n,i,l,c,a;return{c(){t=T("div"),r=T("h3"),s=T("i"),i=F(e[0]),this.h()},l(o){t=b(o,"DIV",{style:!0,id:!0,class:!0});var u=R(t);r=b(u,"H3",{class:!0});var d=R(r);s=b(d,"I",{class:!0}),R(s).forEach(E),i=M(d,e[0]),d.forEach(E),u.forEach(E),this.h()},h(){_(s,"class",n="bx "+e[5]+" svelte-1bnrt9"),_(r,"class","svelte-1bnrt9"),L(t,"cursor","pointer"),_(t,"id",e[0]),_(t,"class",l=C(e[2])+" svelte-1bnrt9")},m(o,u){N(o,t,u),v(t,r),v(r,s),v(r,i),c||(a=Y(t,"click",e[6]),c=!0)},p(o,u){u&32&&n!==(n="bx "+o[5]+" svelte-1bnrt9")&&_(s,"class",n),u&1&&U(i,o[0]),u&1&&_(t,"id",o[0]),u&4&&l!==(l=C(o[2])+" svelte-1bnrt9")&&_(t,"class",l)},d(o){o&&E(t),c=!1,a()}}}function Z(e){let t,r,s,n,i,l,c,a;return{c(){t=T("div"),r=T("h4"),s=T("i"),i=F(e[0]),this.h()},l(o){t=b(o,"DIV",{style:!0,id:!0,class:!0});var u=R(t);r=b(u,"H4",{class:!0});var d=R(r);s=b(d,"I",{class:!0}),R(s).forEach(E),i=M(d,e[0]),d.forEach(E),u.forEach(E),this.h()},h(){_(s,"class",n="bx "+e[5]+" svelte-1bnrt9"),_(r,"class","svelte-1bnrt9"),L(t,"cursor","pointer"),_(t,"id",e[0]),_(t,"class",l=C(e[2])+" svelte-1bnrt9")},m(o,u){N(o,t,u),v(t,r),v(r,s),v(r,i),c||(a=Y(t,"click",e[6]),c=!0)},p(o,u){u&32&&n!==(n="bx "+o[5]+" svelte-1bnrt9")&&_(s,"class",n),u&1&&U(i,o[0]),u&1&&_(t,"id",o[0]),u&4&&l!==(l=C(o[2])+" svelte-1bnrt9")&&_(t,"class",l)},d(o){o&&E(t),c=!1,a()}}}function D(e){let t,r,s,n,i,l,c,a;return{c(){t=T("div"),r=T("h6"),s=T("i"),i=F(e[0]),this.h()},l(o){t=b(o,"DIV",{style:!0,id:!0,class:!0});var u=R(t);r=b(u,"H6",{class:!0});var d=R(r);s=b(d,"I",{class:!0}),R(s).forEach(E),i=M(d,e[0]),d.forEach(E),u.forEach(E),this.h()},h(){_(s,"class",n="bx "+e[5]+" svelte-1bnrt9"),_(r,"class","svelte-1bnrt9"),L(t,"cursor","pointer"),_(t,"id",e[0]),_(t,"class",l=C(e[2])+" svelte-1bnrt9")},m(o,u){N(o,t,u),v(t,r),v(r,s),v(r,i),c||(a=Y(t,"click",e[6]),c=!0)},p(o,u){u&32&&n!==(n="bx "+o[5]+" svelte-1bnrt9")&&_(s,"class",n),u&1&&U(i,o[0]),u&1&&_(t,"id",o[0]),u&4&&l!==(l=C(o[2])+" svelte-1bnrt9")&&_(t,"class",l)},d(o){o&&E(t),c=!1,a()}}}function ve(e){let t,r,s,n,i,l,c,a=e[1]=="2"&&J(e),o=e[1]=="3"&&Q(e),u=e[1]=="4"&&Z(e),d=e[1]=="5"&&D(e);const S=e[10].default,I=ue(S,e,e[9],null);return{c(){t=T("div"),a&&a.c(),r=V(),o&&o.c(),s=V(),u&&u.c(),n=V(),d&&d.c(),i=V(),l=T("div"),I&&I.c(),this.h()},l(f){t=b(f,"DIV",{});var g=R(t);a&&a.l(g),r=G(g),o&&o.l(g),s=G(g),u&&u.l(g),n=G(g),d&&d.l(g),i=G(g),l=b(g,"DIV",{style:!0,class:!0});var w=R(l);I&&I.l(w),w.forEach(E),g.forEach(E),this.h()},h(){L(l,"display",e[4]),_(l,"class","body svelte-1bnrt9"),W(t,"collapsible",!0),W(t,"bg-light",e[3])},m(f,g){N(f,t,g),a&&a.m(t,null),v(t,r),o&&o.m(t,null),v(t,s),u&&u.m(t,null),v(t,n),d&&d.m(t,null),v(t,i),v(t,l),I&&I.m(l,null),c=!0},p(f,[g]){f[1]=="2"?a?a.p(f,g):(a=J(f),a.c(),a.m(t,r)):a&&(a.d(1),a=null),f[1]=="3"?o?o.p(f,g):(o=Q(f),o.c(),o.m(t,s)):o&&(o.d(1),o=null),f[1]=="4"?u?u.p(f,g):(u=Z(f),u.c(),u.m(t,n)):u&&(u.d(1),u=null),f[1]=="5"?d?d.p(f,g):(d=D(f),d.c(),d.m(t,i)):d&&(d.d(1),d=null),I&&I.p&&(!c||g&512)&&ae(I,S,f,f[9],c?de(S,f[9],g,null):ce(f[9]),null),(!c||g&16)&&L(l,"display",f[4]),(!c||g&8)&&W(t,"bg-light",f[3])},i(f){c||(he(I,f),c=!0)},o(f){_e(I,f),c=!1},d(f){f&&E(t),a&&a.d(),o&&o.d(),u&&u.d(),d&&d.d(),I&&I.d(f)}}}function Te(e,t,r){let{$$slots:s={},$$scope:n}=t,{header:i}=t,{open:l=!1}=t,{level:c="2"}=t,{class_:a=""}=t,{highlight:o=!1}=t,{onClose:u=()=>{}}=t,d="none",S="bx-chevron-down";const I=()=>{d==="block"?(u(),r(4,d="none")):r(4,d="block")};return e.$$set=f=>{"header"in f&&r(0,i=f.header),"open"in f&&r(7,l=f.open),"level"in f&&r(1,c=f.level),"class_"in f&&r(2,a=f.class_),"highlight"in f&&r(3,o=f.highlight),"onClose"in f&&r(8,u=f.onClose),"$$scope"in f&&r(9,n=f.$$scope)},e.$$.update=()=>{e.$$.dirty&128&&l&&r(4,d="block"),e.$$.dirty&16&&(d==="block"?r(5,S="bx-chevron-down"):r(5,S="bx-chevron-right"))},[i,c,a,o,d,S,I,l,u,n,s]}class nt extends q{constructor(t){super(),X(this,t,Te,ve,j,{header:0,open:7,level:1,class_:2,highlight:3,onClose:8})}}const h={ACKNOWLEDGEMENTS:"acknowledgements",AGGREGATE_SEVERITY:"aggregate_severity",ALIASES:"aliases",CATEGORY:"category",CONTACT_DETAILS:"contact_details",CSAFVERSION:"csaf_version",CURRENTRELEASEDATE:"current_release_date",DISTRIBUTION:"distribution",DOCUMENT:"document",GENERATOR:"generator",ID:"id",INITIALRELEASEDATE:"initial_release_date",ISSUING_AUTHORITY:"issuing_authority",LABEL:"label",LANG:"lang",NOTES:"notes",PRODUCTTREE:"product_tree",PUBLISHER_CATEGORY:"category",PUBLISHER_NAME:"name",PUBLISHER_NAMESPACE:"namespace",PUBLISHER:"publisher",REFERENCES:"references",REVISIONHISTORY:"revision_history",STATUS:"status",SOURCELANG:"sourcelang",TITLE:"title",TLP:"tlp",TRACKING:"tracking",TRACKINGVERSION:"version",VULNERABILITIES:"vulnerabilities"},k={AMBER:"AMBER",GREEN:"GREEN",RED:"RED",WHITE:"WHITE",ERROR:"Invalid TLP"},p="",O={draft:"draft",final:"final",interim:"interim",ERROR:"Invalid Status"};function x(e,t,r){const s=e.slice();return s[5]=t[r],s[7]=r,s}function $(e){let t,r,s,n,i=e[5]+"",l,c,a=e[1][e[7]]+"",o,u;return{c(){t=T("table"),r=T("tbody"),s=T("tr"),n=T("td"),l=F(i),c=T("td"),o=F(a),u=V(),this.h()},l(d){t=b(d,"TABLE",{});var S=R(t);r=b(S,"TBODY",{});var I=R(r);s=b(I,"TR",{});var f=R(s);n=b(f,"TD",{style:!0});var g=R(n);l=M(g,i),g.forEach(E),c=b(f,"TD",{class:!0});var w=R(c);o=M(w,a),w.forEach(E),f.forEach(E),I.forEach(E),u=G(S),S.forEach(E),this.h()},h(){_(n,"style",e[2]),_(c,"class","value svelte-17j73i")},m(d,S){N(d,t,S),v(t,r),v(r,s),v(s,n),v(n,l),v(s,c),v(c,o),v(t,u)},p(d,S){S&1&&i!==(i=d[5]+"")&&U(l,i),S&4&&_(n,"style",d[2]),S&2&&a!==(a=d[1][d[7]]+"")&&U(o,a)},d(d){d&&E(t)}}}function be(e){let t,r=z(e[0]),s=[];for(let n=0;n<r.length;n+=1)s[n]=$(x(e,r,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();t=K()},l(n){for(let i=0;i<s.length;i+=1)s[i].l(n);t=K()},m(n,i){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(n,i);N(n,t,i)},p(n,[i]){if(i&7){r=z(n[0]);let l;for(l=0;l<r.length;l+=1){const c=x(n,r,l);s[l]?s[l].p(c,i):(s[l]=$(c),s[l].c(),s[l].m(t.parentNode,t))}for(;l<s.length;l+=1)s[l].d(1);s.length=r.length}},i:H,o:H,d(n){n&&E(t),Ee(s,n)}}}function Re(e,t,r){let s,{keys:n}=t,{values:i}=t,{compact:l=!1}=t,c=l?"width:8vw":"width: 15vw;";return e.$$set=a=>{"keys"in a&&r(0,n=a.keys),"values"in a&&r(1,i=a.values),"compact"in a&&r(3,l=a.compact)},r(2,s=`padding: 0.2rem; ${c}`),[n,i,s,l]}class it extends q{constructor(t){super(),X(this,t,Re,be,j,{keys:0,values:1,compact:3})}}const y={FIXED:"F",UNDER_INVESTIGATION:"U",KNOWN_AFFECTED:"K",NOT_AFFECTED:"N",RECOMMENDED:"R"},pe=(e,t,r)=>{const{vulnerabilities:s,relevantProducts:n}=Pe(e);return t=t.filter(l=>n[l.product_id]),s.sort((l,c)=>l.cve<c.cve?-1:l.cve>c.cve?1:0),Ie(t,s,r)},Ie=(e,t,r)=>{let s=[],n=["Product","Total result"];const i=t.map(c=>c.cve);n=n.concat(i),s.push(n);const l=e.map(c=>{let a=[`${c.product_id}`];return a=a.concat(Se(c,t)),a});return l.sort((c,a)=>r[c[0]]<r[a[0]]?-1:r[c[0]]>r[a[0]]?1:0),s=[...s,...l],s},Se=(e,t)=>{const r="N.A",s=[r];t.forEach(i=>{var c,a,o,u,d;let l="";(c=i.fixed)!=null&&c[e.product_id]&&(l+=y.FIXED),(a=i.under_investigation)!=null&&a[e.product_id]&&(l+=y.UNDER_INVESTIGATION),(o=i.known_affected)!=null&&o[e.product_id]&&(l+=y.KNOWN_AFFECTED),(u=i.known_not_affected)!=null&&u[e.product_id]&&(l+=y.NOT_AFFECTED),(d=i.recommended)!=null&&d[e.product_id]&&(l+=y.RECOMMENDED),s.push(l)});const n=i=>{let l=r;switch(!0){case i.includes("K"):l="K";break;case i.includes("U"):l="U";break;case i.includes("F"):l="F";break;case i.includes("NR"):case i.includes("N"):l="N";break}return l};return s[0]=n(s),s},Ae=e=>{if(!e.product_tree||!e.product_tree.branches)return[];const t=e.product_tree.branches.reduce(te,[]),r=ke(e);return t.concat(r)},ke=e=>e.product_tree.relationships?e.product_tree.relationships.map(t=>({product_id:t.full_product_name.product_id,name:t.full_product_name.name})):[],te=(e,t)=>(t.branches?t.branches.forEach(r=>{e.concat(te(e,r))}):Ne(t)&&e.push({product_id:t.product.product_id,name:t.product.name}),e),Ne=e=>e.product&&e.product.product_id&&e.product.name,B=(e,t)=>{var r;return(r=e[t])==null?void 0:r.reduce((s,n)=>(s[n]=n,s),{})},Pe=e=>{const t={vulnerabilities:[],relevantProducts:{}};if(!e.vulnerabilities)return t;const r=e.vulnerabilities.reduce((s,n)=>{if(!n.cve)return s;const i={cve:n.cve};return n.product_status&&(n.product_status.known_affected&&(i.known_affected=B(n.product_status,"known_affected"),Object.assign(t.relevantProducts,i.known_affected)),n.product_status.fixed&&(i.fixed=B(n.product_status,"fixed"),Object.assign(t.relevantProducts,i.fixed)),n.product_status.under_investigation&&(i.under_investigation=B(n.product_status,"under_investigation"),Object.assign(t.relevantProducts,i.under_investigation)),n.product_status.known_not_affected&&(i.known_not_affected=B(n.product_status,"known_not_affected"),Object.assign(t.relevantProducts,i.known_not_affected)),n.product_status.recommended&&(i.recommended=B(n.product_status,"recommended"),Object.assign(t.relevantProducts,i.recommended))),s.push(i),s},[]);return t.vulnerabilities=r,t},A=e=>e[h.DOCUMENT],P=e=>A(e)&&e.document[h.TRACKING],re=e=>A(e)&&e.document[h.DISTRIBUTION],se=e=>re(e)&&e.document.distribution[h.TLP]&&e.document.distribution[h.TLP][h.LABEL],ne=e=>A(e)&&e.document[h.PUBLISHER],ie=e=>e[h.VULNERABILITIES],le=e=>e[h.PRODUCTTREE],oe=e=>P(e)&&e.document.tracking[h.REVISIONHISTORY],Ce=e=>A(e)&&e.document[h.TITLE]||p,Oe=e=>A(e)&&e.document[h.LANG]||p,Le=e=>A(e)&&e.document[h.CSAFVERSION]||p,Fe=e=>P(e)&&e.document.tracking[h.ID]||p,Me=e=>{if(!se(e))return{label:""};let t="TLP.ERROR;";switch(e.document.distribution.tlp[h.LABEL]){case k.AMBER:t=k.AMBER;break;case k.GREEN:t=k.AMBER;break;case k.WHITE:t=k.WHITE;break;case k.RED:t=k.RED;break;default:t=k.ERROR;break}return{label:t,url:e.document.distribution.tlp.url}},Ue=e=>{if(!P(e))return p;switch(e.document.tracking[h.STATUS]){case O.draft:return O.draft;case O.final:return O.final;case O.interim:return O.interim;default:return O.ERROR}},we=e=>P(e)&&e.document.tracking[h.INITIALRELEASEDATE]||p,ye=e=>P(e)&&e.document.tracking[h.CURRENTRELEASEDATE]||p,Be=e=>A(e)&&e.document[h.CATEGORY]||p,Ve=e=>{if(!ne(e))return{category:"",name:"",namespace:""};const t=e.document[h.PUBLISHER];return{category:t[h.PUBLISHER_CATEGORY],name:t[h.PUBLISHER_NAME],namespace:t[h.PUBLISHER_NAMESPACE],contact_details:t[h.CONTACT_DETAILS],issuing_authority:t[h.ISSUING_AUTHORITY]}},Ge=e=>P(e)&&e.document.tracking[h.TRACKINGVERSION]||p,He=e=>ie(e)?e.vulnerabilities:[],Ye=e=>{if(!oe(e))return[];const t=e.document.tracking[h.REVISIONHISTORY];return t.sort((r,s)=>r.date<s.date?1:r.date>s.date?-1:0),t},Ke=e=>le(e)?e[h.PRODUCTTREE]:[],We=e=>A(e)?e.document[h.NOTES]:[],je=e=>A(e)?e.document[h.ACKNOWLEDGEMENTS]:[],qe=e=>A(e)&&e.document[h.SOURCELANG]||p,Xe=e=>A(e)?e.document[h.REFERENCES]||[]:[],ze=e=>A(e)&&e.document[h.AGGREGATE_SEVERITY]||null,Je=e=>P(e)&&e.document.tracking[h.GENERATOR]||null,Qe=e=>P(e)&&e.document.tracking[h.ALIASES]||null,Ze=e=>{const t={aggregateSeverity:ze(e),acknowledgements:je(e),aliases:Qe(e),category:Be(e),csafVersion:Le(e),generator:Je(e),id:Fe(e),isDistributionPresent:re(e),isDocPresent:A(e),isProductTreePresent:le(e),isPublisherPresent:ne(e),isRevisionHistoryPresent:oe(e),isTLPPresent:se(e),isTrackingPresent:P(e),isVulnerabilitiesPresent:ie(e),lang:Oe(e),lastUpdate:ye(e),notes:We(e),productsByID:{},productTree:Ke(e),productVulnerabilities:[],published:we(e),publisher:Ve(e),references:Xe(e),revisionHistory:Ye(e),status:Ue(e),sourceLang:qe(e),title:Ce(e),tlp:Me(e),trackingVersion:Ge(e),vulnerabilities:He(e)},r=Ae(e),s=r.reduce((n,i)=>(n[i.product_id]=i.name,n),{});return t.productsByID=s,t.productVulnerabilities=pe(e,r,s),t};function ee(e){let t,r='Last pos. <i class="bx bx-undo"></i>',s,n;return{c(){t=T("a"),t.innerHTML=r,this.h()},l(i){t=b(i,"A",{class:!0,href:!0,"data-svelte-h":!0}),ge(t)!=="svelte-1dgp8xl"&&(t.innerHTML=r),this.h()},h(){_(t,"class","back button dark svelte-s0h6vx"),_(t,"href","#top")},m(i,l){N(i,t,l),s||(n=Y(t,"click",e[1]),s=!0)},p:H,d(i){i&&E(t),s=!1,n()}}}function De(e){let t,r=e[0].ui.history.length>0&&ee(e);return{c(){r&&r.c(),t=K()},l(s){r&&r.l(s),t=K()},m(s,n){r&&r.m(s,n),N(s,t,n)},p(s,[n]){s[0].ui.history.length>0?r?r.p(s,n):(r=ee(s),r.c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null)},i:H,o:H,d(s){s&&E(t),r&&r.d(s)}}}async function xe(e){setTimeout(()=>{const r=document.getElementById(`${e}`).getBoundingClientRect().top+window.scrollY-150;window.scrollTo({top:r,behavior:"smooth"})},200)}function $e(e,t,r){let s;return fe(e,m,i=>r(0,s=i)),[s,i=>{const l=s.ui.history[0];m.shiftHistory(),xe(l),i.preventDefault()}]}class lt extends q{constructor(t){super(),X(this,t,$e,De,j,{})}}const ot=me("goto");async function ut(e){m.setSingleErrorMsg("");try{const t=await fetch(`${e}`);if(t.ok){const r=await t.json();m.clearUploadedFile();const s=Ze(r);m.setDocument(s)}t.status===404&&m.setSingleErrorMsg("The resource you requested was not found on the server.")}catch{m.setSingleErrorMsg("Failed to load from URL. The server may be unreachable or the resource cannot be accessed due to CORS restrictions.")}}async function at(e){m.setFeedErrorMsg("");try{const t=await fetch(`${e}`);if(t.ok){m.setCurrentFeed(null),m.setProviderMetadata(null);const r=await t.json();m.setProviderMetadata(r)}t.status===404&&(m.setFeedErrorMsg("The resource you requested was not found on the server."),m.setProviderMetadata(null))}catch{m.setFeedErrorMsg("Failed to load from URL. The server may be unreachable or the resource cannot be accessed due to CORS restrictions."),m.setProviderMetadata(null)}}async function ct(e,t){m.setFeedErrorMsg("");try{const r=await fetch(`${e}`);if(r.ok){const s=await r.json();m.setCurrentFeed(null),m.setCurrentFeed(s),m.setFeedSectionOpen(),t&&m.unshiftHistory(t.target.id),setTimeout(()=>{const n=document.getElementById(`${e}`);n==null||n.scrollIntoView({block:"start",behavior:"smooth"})},100)}r.status===404&&(m.setFeedErrorMsg("The resource you requested was not found on the server."),m.setCurrentFeed(null))}catch{m.setFeedErrorMsg("Failed to load from URL. The server may be unreachable or the resource cannot be accessed due to CORS restrictions."),m.setCurrentFeed(null)}}export{lt as B,nt as C,it as K,y as P,O as S,k as T,at as a,ct as b,Ze as c,z as e,ot as g,ut as l};
