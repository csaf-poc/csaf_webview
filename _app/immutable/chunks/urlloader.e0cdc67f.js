import{s as j,c as ae,u as ue,g as ce,d as de,f as C,n as H,e as fe}from"./scheduler.8b5db029.js";import{S as q,i as X,g as T,s as V,h as b,j as R,c as G,f as E,l as L,k as _,B as W,a as N,y as v,d as he,t as _e,m as F,n as M,z as Y,o as U,e as K,A as Ee,x as ge}from"./index.0646f6aa.js";import{a as m}from"./store.b21f0027.js";import{j as me}from"./singletons.71bd54bb.js";function z(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function J(e){let t,s,r,n,i,l,c,u;return{c(){t=T("div"),s=T("h2"),r=T("i"),i=F(e[0]),this.h()},l(o){t=b(o,"DIV",{style:!0,id:!0,class:!0});var a=R(t);s=b(a,"H2",{class:!0});var d=R(s);r=b(d,"I",{class:!0}),R(r).forEach(E),i=M(d,e[0]),d.forEach(E),a.forEach(E),this.h()},h(){_(r,"class",n="bx "+e[5]+" svelte-1e305ab"),_(s,"class","svelte-1e305ab"),L(t,"cursor","pointer"),_(t,"id",e[0]),_(t,"class",l=C(e[2])+" svelte-1e305ab")},m(o,a){N(o,t,a),v(t,s),v(s,r),v(s,i),c||(u=Y(t,"click",e[6]),c=!0)},p(o,a){a&32&&n!==(n="bx "+o[5]+" svelte-1e305ab")&&_(r,"class",n),a&1&&U(i,o[0]),a&1&&_(t,"id",o[0]),a&4&&l!==(l=C(o[2])+" svelte-1e305ab")&&_(t,"class",l)},d(o){o&&E(t),c=!1,u()}}}function Q(e){let t,s,r,n,i,l,c,u;return{c(){t=T("div"),s=T("h3"),r=T("i"),i=F(e[0]),this.h()},l(o){t=b(o,"DIV",{style:!0,id:!0,class:!0});var a=R(t);s=b(a,"H3",{class:!0});var d=R(s);r=b(d,"I",{class:!0}),R(r).forEach(E),i=M(d,e[0]),d.forEach(E),a.forEach(E),this.h()},h(){_(r,"class",n="bx "+e[5]+" svelte-1e305ab"),_(s,"class","svelte-1e305ab"),L(t,"cursor","pointer"),_(t,"id",e[0]),_(t,"class",l=C(e[2])+" svelte-1e305ab")},m(o,a){N(o,t,a),v(t,s),v(s,r),v(s,i),c||(u=Y(t,"click",e[6]),c=!0)},p(o,a){a&32&&n!==(n="bx "+o[5]+" svelte-1e305ab")&&_(r,"class",n),a&1&&U(i,o[0]),a&1&&_(t,"id",o[0]),a&4&&l!==(l=C(o[2])+" svelte-1e305ab")&&_(t,"class",l)},d(o){o&&E(t),c=!1,u()}}}function Z(e){let t,s,r,n,i,l,c,u;return{c(){t=T("div"),s=T("h4"),r=T("i"),i=F(e[0]),this.h()},l(o){t=b(o,"DIV",{style:!0,id:!0,class:!0});var a=R(t);s=b(a,"H4",{class:!0});var d=R(s);r=b(d,"I",{class:!0}),R(r).forEach(E),i=M(d,e[0]),d.forEach(E),a.forEach(E),this.h()},h(){_(r,"class",n="bx "+e[5]+" svelte-1e305ab"),_(s,"class","svelte-1e305ab"),L(t,"cursor","pointer"),_(t,"id",e[0]),_(t,"class",l=C(e[2])+" svelte-1e305ab")},m(o,a){N(o,t,a),v(t,s),v(s,r),v(s,i),c||(u=Y(t,"click",e[6]),c=!0)},p(o,a){a&32&&n!==(n="bx "+o[5]+" svelte-1e305ab")&&_(r,"class",n),a&1&&U(i,o[0]),a&1&&_(t,"id",o[0]),a&4&&l!==(l=C(o[2])+" svelte-1e305ab")&&_(t,"class",l)},d(o){o&&E(t),c=!1,u()}}}function D(e){let t,s,r,n,i,l,c,u;return{c(){t=T("div"),s=T("h6"),r=T("i"),i=F(e[0]),this.h()},l(o){t=b(o,"DIV",{style:!0,id:!0,class:!0});var a=R(t);s=b(a,"H6",{class:!0});var d=R(s);r=b(d,"I",{class:!0}),R(r).forEach(E),i=M(d,e[0]),d.forEach(E),a.forEach(E),this.h()},h(){_(r,"class",n="bx "+e[5]+" svelte-1e305ab"),_(s,"class","svelte-1e305ab"),L(t,"cursor","pointer"),_(t,"id",e[0]),_(t,"class",l=C(e[2])+" svelte-1e305ab")},m(o,a){N(o,t,a),v(t,s),v(s,r),v(s,i),c||(u=Y(t,"click",e[6]),c=!0)},p(o,a){a&32&&n!==(n="bx "+o[5]+" svelte-1e305ab")&&_(r,"class",n),a&1&&U(i,o[0]),a&1&&_(t,"id",o[0]),a&4&&l!==(l=C(o[2])+" svelte-1e305ab")&&_(t,"class",l)},d(o){o&&E(t),c=!1,u()}}}function ve(e){let t,s,r,n,i,l,c,u=e[1]=="2"&&J(e),o=e[1]=="3"&&Q(e),a=e[1]=="4"&&Z(e),d=e[1]=="5"&&D(e);const S=e[10].default,I=ae(S,e,e[9],null);return{c(){t=T("div"),u&&u.c(),s=V(),o&&o.c(),r=V(),a&&a.c(),n=V(),d&&d.c(),i=V(),l=T("div"),I&&I.c(),this.h()},l(f){t=b(f,"DIV",{});var g=R(t);u&&u.l(g),s=G(g),o&&o.l(g),r=G(g),a&&a.l(g),n=G(g),d&&d.l(g),i=G(g),l=b(g,"DIV",{style:!0,class:!0});var w=R(l);I&&I.l(w),w.forEach(E),g.forEach(E),this.h()},h(){L(l,"display",e[4]),_(l,"class","body svelte-1e305ab"),W(t,"collapsible",!0),W(t,"bg-light",e[3])},m(f,g){N(f,t,g),u&&u.m(t,null),v(t,s),o&&o.m(t,null),v(t,r),a&&a.m(t,null),v(t,n),d&&d.m(t,null),v(t,i),v(t,l),I&&I.m(l,null),c=!0},p(f,[g]){f[1]=="2"?u?u.p(f,g):(u=J(f),u.c(),u.m(t,s)):u&&(u.d(1),u=null),f[1]=="3"?o?o.p(f,g):(o=Q(f),o.c(),o.m(t,r)):o&&(o.d(1),o=null),f[1]=="4"?a?a.p(f,g):(a=Z(f),a.c(),a.m(t,n)):a&&(a.d(1),a=null),f[1]=="5"?d?d.p(f,g):(d=D(f),d.c(),d.m(t,i)):d&&(d.d(1),d=null),I&&I.p&&(!c||g&512)&&ue(I,S,f,f[9],c?de(S,f[9],g,null):ce(f[9]),null),(!c||g&16)&&L(l,"display",f[4]),(!c||g&8)&&W(t,"bg-light",f[3])},i(f){c||(he(I,f),c=!0)},o(f){_e(I,f),c=!1},d(f){f&&E(t),u&&u.d(),o&&o.d(),a&&a.d(),d&&d.d(),I&&I.d(f)}}}function Te(e,t,s){let{$$slots:r={},$$scope:n}=t,{header:i}=t,{open:l=!1}=t,{level:c="2"}=t,{class_:u=""}=t,{highlight:o=!1}=t,{onClose:a=()=>{}}=t,d="none",S="bx-chevron-down";const I=()=>{d==="block"?(a(),s(4,d="none")):s(4,d="block")};return e.$$set=f=>{"header"in f&&s(0,i=f.header),"open"in f&&s(7,l=f.open),"level"in f&&s(1,c=f.level),"class_"in f&&s(2,u=f.class_),"highlight"in f&&s(3,o=f.highlight),"onClose"in f&&s(8,a=f.onClose),"$$scope"in f&&s(9,n=f.$$scope)},e.$$.update=()=>{e.$$.dirty&128&&l&&s(4,d="block"),e.$$.dirty&16&&(d==="block"?s(5,S="bx-chevron-down"):s(5,S="bx-chevron-right"))},[i,c,u,o,d,S,I,l,a,n,r]}class nt extends q{constructor(t){super(),X(this,t,Te,ve,j,{header:0,open:7,level:1,class_:2,highlight:3,onClose:8})}}const h={ACKNOWLEDGEMENTS:"acknowledgements",AGGREGATE_SEVERITY:"aggregate_severity",ALIASES:"aliases",CATEGORY:"category",CONTACT_DETAILS:"contact_details",CSAFVERSION:"csaf_version",CURRENTRELEASEDATE:"current_release_date",DISTRIBUTION:"distribution",DOCUMENT:"document",GENERATOR:"generator",ID:"id",INITIALRELEASEDATE:"initial_release_date",ISSUING_AUTHORITY:"issuing_authority",LABEL:"label",LANG:"lang",NOTES:"notes",PRODUCTTREE:"product_tree",PUBLISHER_CATEGORY:"category",PUBLISHER_NAME:"name",PUBLISHER_NAMESPACE:"namespace",PUBLISHER:"publisher",REFERENCES:"references",REVISIONHISTORY:"revision_history",STATUS:"status",SOURCELANG:"sourcelang",TITLE:"title",TLP:"tlp",TRACKING:"tracking",TRACKINGVERSION:"version",VULNERABILITIES:"vulnerabilities"},k={AMBER:"AMBER",GREEN:"GREEN",RED:"RED",WHITE:"WHITE",ERROR:"Invalid TLP"},p="",O={draft:"draft",final:"final",interim:"interim",ERROR:"Invalid Status"};function x(e,t,s){const r=e.slice();return r[5]=t[s],r[7]=s,r}function $(e){let t,s,r,n,i=e[5]+"",l,c,u=e[1][e[7]]+"",o,a;return{c(){t=T("table"),s=T("tbody"),r=T("tr"),n=T("td"),l=F(i),c=T("td"),o=F(u),a=V(),this.h()},l(d){t=b(d,"TABLE",{});var S=R(t);s=b(S,"TBODY",{});var I=R(s);r=b(I,"TR",{});var f=R(r);n=b(f,"TD",{style:!0});var g=R(n);l=M(g,i),g.forEach(E),c=b(f,"TD",{class:!0});var w=R(c);o=M(w,u),w.forEach(E),f.forEach(E),I.forEach(E),a=G(S),S.forEach(E),this.h()},h(){_(n,"style",e[2]),_(c,"class","value svelte-17j73i")},m(d,S){N(d,t,S),v(t,s),v(s,r),v(r,n),v(n,l),v(r,c),v(c,o),v(t,a)},p(d,S){S&1&&i!==(i=d[5]+"")&&U(l,i),S&4&&_(n,"style",d[2]),S&2&&u!==(u=d[1][d[7]]+"")&&U(o,u)},d(d){d&&E(t)}}}function be(e){let t,s=z(e[0]),r=[];for(let n=0;n<s.length;n+=1)r[n]=$(x(e,s,n));return{c(){for(let n=0;n<r.length;n+=1)r[n].c();t=K()},l(n){for(let i=0;i<r.length;i+=1)r[i].l(n);t=K()},m(n,i){for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(n,i);N(n,t,i)},p(n,[i]){if(i&7){s=z(n[0]);let l;for(l=0;l<s.length;l+=1){const c=x(n,s,l);r[l]?r[l].p(c,i):(r[l]=$(c),r[l].c(),r[l].m(t.parentNode,t))}for(;l<r.length;l+=1)r[l].d(1);r.length=s.length}},i:H,o:H,d(n){n&&E(t),Ee(r,n)}}}function Re(e,t,s){let r,{keys:n}=t,{values:i}=t,{compact:l=!1}=t,c=l?"width:8vw":"width: 15vw;";return e.$$set=u=>{"keys"in u&&s(0,n=u.keys),"values"in u&&s(1,i=u.values),"compact"in u&&s(3,l=u.compact)},s(2,r=`padding: 0.2rem; ${c}`),[n,i,r,l]}class it extends q{constructor(t){super(),X(this,t,Re,be,j,{keys:0,values:1,compact:3})}}const y={FIXED:"F",UNDER_INVESTIGATION:"U",KNOWN_AFFECTED:"K",NOT_AFFECTED:"N",RECOMMENDED:"R"},pe=(e,t,s)=>{const{vulnerabilities:r,relevantProducts:n}=Pe(e);return t=t.filter(l=>n[l.product_id]),r.sort((l,c)=>l.cve<c.cve?-1:l.cve>c.cve?1:0),Ie(t,r,s)},Ie=(e,t,s)=>{let r=[],n=["Product","Total result"];const i=t.map(c=>c.cve);n=n.concat(i),r.push(n);const l=e.map(c=>{let u=[`${c.product_id}`];return u=u.concat(Se(c,t)),u});return l.sort((c,u)=>s[c[0]]<s[u[0]]?-1:s[c[0]]>s[u[0]]?1:0),r=[...r,...l],r},Se=(e,t)=>{const s="N.A",r=[s];t.forEach(i=>{var c,u,o,a,d;let l="";(c=i.fixed)!=null&&c[e.product_id]&&(l+=y.FIXED),(u=i.under_investigation)!=null&&u[e.product_id]&&(l+=y.UNDER_INVESTIGATION),(o=i.known_affected)!=null&&o[e.product_id]&&(l+=y.KNOWN_AFFECTED),(a=i.known_not_affected)!=null&&a[e.product_id]&&(l+=y.NOT_AFFECTED),(d=i.recommended)!=null&&d[e.product_id]&&(l+=y.RECOMMENDED),r.push(l)});const n=i=>{let l=s;switch(!0){case i.includes("K"):l="K";break;case i.includes("U"):l="U";break;case i.includes("F"):l="F";break;case i.includes("NR"):case i.includes("N"):l="N";break}return l};return r[0]=n(r),r},Ae=e=>{if(!e.product_tree||!e.product_tree.branches)return[];const t=e.product_tree.branches.reduce(te,[]),s=ke(e);return t.concat(s)},ke=e=>e.product_tree.relationships?e.product_tree.relationships.map(t=>({product_id:t.full_product_name.product_id,name:t.full_product_name.name})):[],te=(e,t)=>(t.branches?t.branches.forEach(s=>{e.concat(te(e,s))}):Ne(t)&&e.push({product_id:t.product.product_id,name:t.product.name}),e),Ne=e=>e.product&&e.product.product_id&&e.product.name,B=(e,t)=>{var s;return(s=e[t])==null?void 0:s.reduce((r,n)=>(r[n]=n,r),{})},Pe=e=>{const t={vulnerabilities:[],relevantProducts:{}};if(!e.vulnerabilities)return t;const s=e.vulnerabilities.reduce((r,n)=>{if(!n.cve)return r;const i={cve:n.cve};return n.product_status&&(n.product_status.known_affected&&(i.known_affected=B(n.product_status,"known_affected"),Object.assign(t.relevantProducts,i.known_affected)),n.product_status.fixed&&(i.fixed=B(n.product_status,"fixed"),Object.assign(t.relevantProducts,i.fixed)),n.product_status.under_investigation&&(i.under_investigation=B(n.product_status,"under_investigation"),Object.assign(t.relevantProducts,i.under_investigation)),n.product_status.known_not_affected&&(i.known_not_affected=B(n.product_status,"known_not_affected"),Object.assign(t.relevantProducts,i.known_not_affected)),n.product_status.recommended&&(i.recommended=B(n.product_status,"recommended"),Object.assign(t.relevantProducts,i.recommended))),r.push(i),r},[]);return t.vulnerabilities=s,t},A=e=>e[h.DOCUMENT],P=e=>A(e)&&e.document[h.TRACKING],se=e=>A(e)&&e.document[h.DISTRIBUTION],re=e=>se(e)&&e.document.distribution[h.TLP]&&e.document.distribution[h.TLP][h.LABEL],ne=e=>A(e)&&e.document[h.PUBLISHER],ie=e=>e[h.VULNERABILITIES],le=e=>e[h.PRODUCTTREE],oe=e=>P(e)&&e.document.tracking[h.REVISIONHISTORY],Ce=e=>A(e)&&e.document[h.TITLE]||p,Oe=e=>A(e)&&e.document[h.LANG]||p,Le=e=>A(e)&&e.document[h.CSAFVERSION]||p,Fe=e=>P(e)&&e.document.tracking[h.ID]||p,Me=e=>{if(!re(e))return{label:""};let t="TLP.ERROR;";switch(e.document.distribution.tlp[h.LABEL]){case k.AMBER:t=k.AMBER;break;case k.GREEN:t=k.AMBER;break;case k.WHITE:t=k.WHITE;break;case k.RED:t=k.RED;break;default:t=k.ERROR;break}return{label:t,url:e.document.distribution.tlp.url}},Ue=e=>{if(!P(e))return p;switch(e.document.tracking[h.STATUS]){case O.draft:return O.draft;case O.final:return O.final;case O.interim:return O.interim;default:return O.ERROR}},we=e=>P(e)&&e.document.tracking[h.INITIALRELEASEDATE]||p,ye=e=>P(e)&&e.document.tracking[h.CURRENTRELEASEDATE]||p,Be=e=>A(e)&&e.document[h.CATEGORY]||p,Ve=e=>{if(!ne(e))return{category:"",name:"",namespace:""};const t=e.document[h.PUBLISHER];return{category:t[h.PUBLISHER_CATEGORY],name:t[h.PUBLISHER_NAME],namespace:t[h.PUBLISHER_NAMESPACE],contact_details:t[h.CONTACT_DETAILS],issuing_authority:t[h.ISSUING_AUTHORITY]}},Ge=e=>P(e)&&e.document.tracking[h.TRACKINGVERSION]||p,He=e=>ie(e)?e.vulnerabilities:[],Ye=e=>{if(!oe(e))return[];const t=e.document.tracking[h.REVISIONHISTORY];return t.sort((s,r)=>s.date<r.date?1:s.date>r.date?-1:0),t},Ke=e=>le(e)?e[h.PRODUCTTREE]:[],We=e=>A(e)?e.document[h.NOTES]:[],je=e=>A(e)?e.document[h.ACKNOWLEDGEMENTS]:[],qe=e=>A(e)&&e.document[h.SOURCELANG]||p,Xe=e=>A(e)?e.document[h.REFERENCES]||[]:[],ze=e=>A(e)&&e.document[h.AGGREGATE_SEVERITY]||null,Je=e=>P(e)&&e.document.tracking[h.GENERATOR]||null,Qe=e=>P(e)&&e.document.tracking[h.ALIASES]||null,Ze=e=>{const t={aggregateSeverity:ze(e),acknowledgements:je(e),aliases:Qe(e),category:Be(e),csafVersion:Le(e),generator:Je(e),id:Fe(e),isDistributionPresent:se(e),isDocPresent:A(e),isProductTreePresent:le(e),isPublisherPresent:ne(e),isRevisionHistoryPresent:oe(e),isTLPPresent:re(e),isTrackingPresent:P(e),isVulnerabilitiesPresent:ie(e),lang:Oe(e),lastUpdate:ye(e),notes:We(e),productsByID:{},productTree:Ke(e),productVulnerabilities:[],published:we(e),publisher:Ve(e),references:Xe(e),revisionHistory:Ye(e),status:Ue(e),sourceLang:qe(e),title:Ce(e),tlp:Me(e),trackingVersion:Ge(e),vulnerabilities:He(e)},s=Ae(e),r=s.reduce((n,i)=>(n[i.product_id]=i.name,n),{});return t.productsByID=r,t.productVulnerabilities=pe(e,s,r),t};function ee(e){let t,s='Last pos. <i class="bx bx-undo"></i>',r,n;return{c(){t=T("a"),t.innerHTML=s,this.h()},l(i){t=b(i,"A",{class:!0,href:!0,"data-svelte-h":!0}),ge(t)!=="svelte-1dgp8xl"&&(t.innerHTML=s),this.h()},h(){_(t,"class","back button dark svelte-s0h6vx"),_(t,"href","#top")},m(i,l){N(i,t,l),r||(n=Y(t,"click",e[1]),r=!0)},p:H,d(i){i&&E(t),r=!1,n()}}}function De(e){let t,s=e[0].ui.history.length>0&&ee(e);return{c(){s&&s.c(),t=K()},l(r){s&&s.l(r),t=K()},m(r,n){s&&s.m(r,n),N(r,t,n)},p(r,[n]){r[0].ui.history.length>0?s?s.p(r,n):(s=ee(r),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null)},i:H,o:H,d(r){r&&E(t),s&&s.d(r)}}}async function xe(e){setTimeout(()=>{const s=document.getElementById(`${e}`).getBoundingClientRect().top+window.scrollY-150;window.scrollTo({top:s,behavior:"smooth"})},200)}function $e(e,t,s){let r;return fe(e,m,i=>s(0,r=i)),[r,i=>{const l=r.ui.history[0];m.shiftHistory(),xe(l),i.preventDefault()}]}class lt extends q{constructor(t){super(),X(this,t,$e,De,j,{})}}const ot=me("goto");async function at(e){m.setSingleErrorMsg("");try{const t=await fetch(`${e}`);if(t.ok){const s=await t.json();m.clearUploadedFile();const r=Ze(s);m.setDocument(r)}t.status===404&&m.setSingleErrorMsg("The resource you requested was not found on the server.")}catch{m.setSingleErrorMsg("Failed to load from URL. The server may be unreachable or the resource cannot be accessed due to CORS restrictions.")}}async function ut(e){m.setFeedErrorMsg("");try{const t=await fetch(`${e}`);if(t.ok){m.setCurrentFeed(null),m.setProviderMetadata(null);const s=await t.json();m.setProviderMetadata(s)}t.status===404&&(m.setFeedErrorMsg("The resource you requested was not found on the server."),m.setProviderMetadata(null))}catch{m.setFeedErrorMsg("Failed to load from URL. The server may be unreachable or the resource cannot be accessed due to CORS restrictions."),m.setProviderMetadata(null)}}async function ct(e,t){m.setFeedErrorMsg("");try{const s=await fetch(`${e}`);if(s.ok){const r=await s.json();m.setCurrentFeed(null),m.setCurrentFeed(r),m.setFeedSectionOpen(),t&&m.unshiftHistory(t.target.id),setTimeout(()=>{const n=document.getElementById(`${e}`);n==null||n.scrollIntoView({block:"start",behavior:"smooth"})},100)}s.status===404&&(m.setFeedErrorMsg("The resource you requested was not found on the server."),m.setCurrentFeed(null))}catch{m.setFeedErrorMsg("Failed to load from URL. The server may be unreachable or the resource cannot be accessed due to CORS restrictions."),m.setCurrentFeed(null)}}export{lt as B,nt as C,it as K,y as P,O as S,k as T,ut as a,ct as b,Ze as c,z as e,ot as g,at as l};
