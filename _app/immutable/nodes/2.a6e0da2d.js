import{s as re,n as ee,e as ke,f as Ee,r as Pe}from"../chunks/scheduler.8b5db029.js";import{S as ne,i as le,e as ge,a as k,f,g as p,m as w,h,j as b,y as N,n as y,k as c,x as u,o as V,z as K,A as J,B as be,s as we,c as Ne,d as Y,t as te,b as Be,r as Te,u as Re,v as De,w as Ce,p as Me}from"../chunks/index.a6c99fb1.js";import{w as Oe}from"../chunks/singletons.474405fc.js";import{p as Ue}from"../chunks/stores.12b34a3f.js";const C={DOCUMENT:"document",TRACKING:"tracking",DISTRIBUTION:"distribution",TLP:"tlp",TITLE:"title",LANG:"lang",CSAFVERSION:"csaf_version",ID:"id",LABEL:"label",STATUS:"status",INITIALRELEASEDATE:"initial_release_date",CURRENTRELEASEDATE:"current_release_date"},A={AMBER:"AMBER",GREEN:"GREEN",RED:"RED",WHITE:"WHITE",ERROR:"Invalid TLP"},I="",B={draft:"draft",final:"final",interim:"interim",ERROR:"Invalid Status"};function Fe(){const e={doc:null},{subscribe:s,set:t,update:n}=Oe(e);return{subscribe:s,setDocument:o=>n(r=>(r.doc=o,r)),reset:()=>t(e)}}const se=Fe();function Ie(e){var de;let s,t,n,o="TLP",r,l,i,d,a,_="Title",m,v,E,M="ID",S,O,L,x="Language",P,U,F,ae="CSAF-Version",W,X,G,oe="Published",j,Z,H,ie="Last update",z,$,R=((de=e[1].doc)==null?void 0:de.status)!==B.final&&Ae(e);return{c(){s=p("div"),t=p("dl"),n=p("dt"),n.textContent=o,r=p("dd"),l=p("span"),i=w(e[0]),a=p("dt"),a.textContent=_,m=p("dd"),v=w(e[9]),E=p("dt"),E.textContent=M,S=p("dd"),O=w(e[6]),L=p("dt"),L.textContent=x,P=p("dd"),U=w(e[8]),F=p("dt"),F.textContent=ae,W=p("dd"),X=w(e[7]),G=p("dt"),G.textContent=oe,j=p("dd"),Z=w(e[5]),H=p("dt"),H.textContent=ie,z=p("dd"),$=w(e[4]),R&&R.c(),this.h()},l(T){s=h(T,"DIV",{class:!0});var D=b(s);t=h(D,"DL",{});var g=b(t);n=h(g,"DT",{class:!0,"data-svelte-h":!0}),N(n)!=="svelte-ktx0ke"&&(n.textContent=o),r=h(g,"DD",{class:!0});var ue=b(r);l=h(ue,"SPAN",{class:!0});var ce=b(l);i=y(ce,e[0]),ce.forEach(f),ue.forEach(f),a=h(g,"DT",{class:!0,"data-svelte-h":!0}),N(a)!=="svelte-hf466c"&&(a.textContent=_),m=h(g,"DD",{class:!0});var fe=b(m);v=y(fe,e[9]),fe.forEach(f),E=h(g,"DT",{class:!0,"data-svelte-h":!0}),N(E)!=="svelte-zwbns7"&&(E.textContent=M),S=h(g,"DD",{class:!0});var pe=b(S);O=y(pe,e[6]),pe.forEach(f),L=h(g,"DT",{class:!0,"data-svelte-h":!0}),N(L)!=="svelte-1aab11o"&&(L.textContent=x),P=h(g,"DD",{class:!0});var he=b(P);U=y(he,e[8]),he.forEach(f),F=h(g,"DT",{class:!0,"data-svelte-h":!0}),N(F)!=="svelte-1s0hun2"&&(F.textContent=ae),W=h(g,"DD",{class:!0});var me=b(W);X=y(me,e[7]),me.forEach(f),G=h(g,"DT",{class:!0,"data-svelte-h":!0}),N(G)!=="svelte-4ntl4g"&&(G.textContent=oe),j=h(g,"DD",{class:!0});var _e=b(j);Z=y(_e,e[5]),_e.forEach(f),H=h(g,"DT",{class:!0,"data-svelte-h":!0}),N(H)!=="svelte-tmity1"&&(H.textContent=ie),z=h(g,"DD",{class:!0});var ve=b(z);$=y(ve,e[4]),ve.forEach(f),R&&R.l(g),g.forEach(f),D.forEach(f),this.h()},h(){c(n,"class","svelte-1u358bg"),c(l,"class",d=Ee(e[2])+" svelte-1u358bg"),c(r,"class","svelte-1u358bg"),c(a,"class","svelte-1u358bg"),c(m,"class","svelte-1u358bg"),c(E,"class","svelte-1u358bg"),c(S,"class","svelte-1u358bg"),c(L,"class","svelte-1u358bg"),c(P,"class","svelte-1u358bg"),c(F,"class","svelte-1u358bg"),c(W,"class","svelte-1u358bg"),c(G,"class","svelte-1u358bg"),c(j,"class","svelte-1u358bg"),c(H,"class","svelte-1u358bg"),c(z,"class","svelte-1u358bg"),c(s,"class","documentdata")},m(T,D){k(T,s,D),u(s,t),u(t,n),u(t,r),u(r,l),u(l,i),u(t,a),u(t,m),u(m,v),u(t,E),u(t,S),u(S,O),u(t,L),u(t,P),u(P,U),u(t,F),u(t,W),u(W,X),u(t,G),u(t,j),u(j,Z),u(t,H),u(t,z),u(z,$),R&&R.m(t,null)},p(T,D){var g;D&1&&V(i,T[0]),D&4&&d!==(d=Ee(T[2])+" svelte-1u358bg")&&c(l,"class",d),D&512&&V(v,T[9]),D&64&&V(O,T[6]),D&256&&V(U,T[8]),D&128&&V(X,T[7]),D&32&&V(Z,T[5]),D&16&&V($,T[4]),((g=T[1].doc)==null?void 0:g.status)!==B.final?R?R.p(T,D):(R=Ae(T),R.c(),R.m(t,null)):R&&(R.d(1),R=null)},d(T){T&&f(s),R&&R.d()}}}function Ae(e){let s,t="Status",n,o;return{c(){s=p("dt"),s.textContent=t,n=p("dd"),o=w(e[3]),this.h()},l(r){s=h(r,"DT",{class:!0,"data-svelte-h":!0}),N(s)!=="svelte-1e9eis"&&(s.textContent=t),n=h(r,"DD",{class:!0});var l=b(n);o=y(l,e[3]),l.forEach(f),this.h()},h(){c(s,"class","svelte-1u358bg"),c(n,"class","svelte-1u358bg")},m(r,l){k(r,s,l),k(r,n,l),u(n,o)},p(r,l){l&8&&V(o,r[3])},d(r){r&&(f(s),f(n))}}}function Ge(e){let s,t=e[1].doc&&Ie(e);return{c(){t&&t.c(),s=ge()},l(n){t&&t.l(n),s=ge()},m(n,o){t&&t.m(n,o),k(n,s,o)},p(n,[o]){n[1].doc?t?t.p(n,o):(t=Ie(n),t.c(),t.m(s.parentNode,s)):t&&(t.d(1),t=null)},i:ee,o:ee,d(n){n&&f(s),t&&t.d(n)}}}function He(e,s,t){let n,o,r,l,i,d,a,_,m;ke(e,se,E=>t(1,m=E));let v="";return e.$$.update=()=>{var E,M,S,O,L,x,P,U;e.$$.dirty&2&&t(9,n=(E=m.doc)==null?void 0:E.title),e.$$.dirty&2&&t(8,o=(M=m.doc)==null?void 0:M.lang),e.$$.dirty&2&&t(7,r=(S=m.doc)==null?void 0:S.csafVersion),e.$$.dirty&2&&t(0,l=(O=m.doc)==null?void 0:O.tlp),e.$$.dirty&1&&(l===A.WHITE?t(2,v="tlpclear"):l===A.RED?t(2,v="tlred"):l===A.AMBER?t(2,v="tlamber"):l===A.GREEN&&t(2,v="tlgreen")),e.$$.dirty&2&&t(6,i=(L=m.doc)==null?void 0:L.id),e.$$.dirty&2&&t(5,d=(x=m.doc)==null?void 0:x.published),e.$$.dirty&2&&t(4,a=(P=m.doc)==null?void 0:P.lastUpdate),e.$$.dirty&2&&t(3,_=(U=m.doc)==null?void 0:U.status)},[l,m,v,_,a,d,i,r,o,n]}class We extends ne{constructor(s){super(),le(this,s,He,Ge,re,{})}}const q=e=>e.hasOwnProperty(C.DOCUMENT),Q=e=>q(e)&&e.document[C.TRACKING],ye=e=>q(e)&&e.document[C.DISTRIBUTION],Ve=e=>ye(e)&&e.document.distribution[C.TLP]&&e.document.distribution[C.TLP][C.LABEL],je=e=>q(e)&&e.document[C.TITLE]||I,ze=e=>q(e)&&e.document[C.LANG]||I,Ke=e=>q(e)&&e.document[C.CSAFVERSION]||I,qe=e=>Q(e)&&e.document.tracking[C.ID]||I,xe=e=>{if(!Ve(e))return I;switch(e.document.distribution.tlp[C.LABEL]){case A.AMBER:return A.AMBER;case A.GREEN:return A.AMBER;case A.WHITE:return A.WHITE;case A.RED:return A.RED;default:return A.ERROR}},Je=e=>{if(!Q(e))return I;switch(e.document.tracking[C.STATUS]){case B.draft:return B.draft;case B.final:return B.final;case B.interim:return B.interim;default:return B.ERROR}},Ye=e=>Q(e)&&e.document.tracking[C.INITIALRELEASEDATE]||I,Qe=e=>Q(e)&&e.document.tracking[C.CURRENTRELEASEDATE]||I,Xe=e=>({title:je(e),lang:ze(e),csafVersion:Ke(e),tlp:xe(e),id:qe(e),status:Je(e),published:Ye(e),lastUpdate:Qe(e),isDocPresent:q(e),isTrackingPresent:Q(e),isDistributionPresent:ye(e),isTLPPresent:Ve(e)});function Se(e){let s;return{c(){s=p("i"),this.h()},l(t){s=h(t,"I",{class:!0}),b(s).forEach(f),this.h()},h(){c(s,"class","bx bx-error")},m(t,n){k(t,s,n)},d(t){t&&f(s)}}}function Ze(e){let s,t,n,o,r=e[3]&&Se();return{c(){s=p("div"),r&&r.c(),t=w(e[2]),this.h()},l(l){s=h(l,"DIV",{class:!0});var i=b(s);r&&r.l(i),t=y(i,e[2]),i.forEach(f),this.h()},h(){c(s,"class","droparea svelte-n060w0"),K(s,"hover",e[1]),K(s,"bg-error",e[0]==!1),K(s,"bg-success",e[0]==!0)},m(l,i){k(l,s,i),r&&r.m(s,null),u(s,t),n||(o=[J(s,"dragover",be(e[5])),J(s,"dragleave",e[6]),J(s,"drop",be(e[4]))],n=!0)},p(l,[i]){l[3]?r||(r=Se(),r.c(),r.m(s,t)):r&&(r.d(1),r=null),i&4&&V(t,l[2]),i&2&&K(s,"hover",l[1]),i&1&&K(s,"bg-error",l[0]==!1),i&1&&K(s,"bg-success",l[0]==!0)},i:ee,o:ee,d(l){l&&f(s),r&&r.d(),n=!1,Pe(o)}}}function $e(e,s,t){let n,o=!1,r=null,l="Drop your CSAF-file here";const i=m=>{if(m.dataTransfer){const v=m.dataTransfer.files[0];v.type=="application/json"?(t(0,r=!0),t(2,l=`Displaying file "${v.name}".`),d(v)):(t(2,l=`File "${v.name}" has an invalid format.`),t(0,r=!1),se.setDocument(null))}},d=m=>{const v=new FileReader;let E={};v.onload=M=>{if(M.target){try{E=JSON.parse(M.target.result)}catch{}const S=Xe(E);se.setDocument(S)}},v.readAsText(m)},a=()=>{t(1,o=!0)},_=()=>{t(1,o=!1)};return e.$$.update=()=>{e.$$.dirty&1&&t(3,n=r===!1)},[r,o,l,n,i,a,_]}class et extends ne{constructor(s){super(),le(this,s,$e,Ze,re,{})}}function Le(e){let s,t,n,o,r,l,i,d;return n=new et({}),i=new We({}),{c(){s=p("div"),t=p("div"),Te(n.$$.fragment),o=we(),r=p("div"),l=p("div"),Te(i.$$.fragment),this.h()},l(a){s=h(a,"DIV",{class:!0});var _=b(s);t=h(_,"DIV",{class:!0});var m=b(t);Re(n.$$.fragment,m),m.forEach(f),_.forEach(f),o=Ne(a),r=h(a,"DIV",{class:!0});var v=b(r);l=h(v,"DIV",{class:!0});var E=b(l);Re(i.$$.fragment,E),E.forEach(f),v.forEach(f),this.h()},h(){c(t,"class","col"),c(s,"class","row"),c(l,"class","col"),c(r,"class","row")},m(a,_){k(a,s,_),u(s,t),De(n,t,null),k(a,o,_),k(a,r,_),u(r,l),De(i,l,null),d=!0},i(a){d||(Y(n.$$.fragment,a),Y(i.$$.fragment,a),d=!0)},o(a){te(n.$$.fragment,a),te(i.$$.fragment,a),d=!1},d(a){a&&(f(s),f(o),f(r)),Ce(n),Ce(i)}}}function tt(e){let s,t,n="CSAF Webview+",o,r,l,i,d=e[0]&&Le();return{c(){s=p("div"),t=p("h1"),t.textContent=n,o=we(),d&&d.c(),this.h()},l(a){s=h(a,"DIV",{class:!0});var _=b(s);t=h(_,"H1",{role:!0,class:!0,"data-svelte-h":!0}),N(t)!=="svelte-1obxzj0"&&(t.textContent=n),o=Ne(_),d&&d.l(_),_.forEach(f),this.h()},h(){c(t,"role","heading"),c(t,"class","text-center"),c(s,"class","container")},m(a,_){k(a,s,_),u(s,t),u(s,o),d&&d.m(s,null),r=!0,l||(i=[J(window,"dragover",e[1]),J(window,"drop",e[1])],l=!0)},p(a,[_]){a[0]?d?_&1&&Y(d,1):(d=Le(),d.c(),Y(d,1),d.m(s,null)):d&&(Me(),te(d,1,1,()=>{d=null}),Be())},i(a){r||(Y(d),r=!0)},o(a){te(d),r=!1},d(a){a&&f(s),d&&d.d(),l=!1,Pe(i)}}}function st(e,s,t){let n,o;ke(e,Ue,i=>t(2,o=i));const r=o.url.searchParams.get("ref"),l=i=>{i.preventDefault()};return t(0,n=!r),[n,l]}class ot extends ne{constructor(s){super(),le(this,s,st,tt,re,{})}}export{ot as component};
