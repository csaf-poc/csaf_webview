import{s as le,n as se,e as we,f as Te,r as Ne}from"../chunks/scheduler.8b5db029.js";import{S as ae,i as oe,e as Re,a as B,f as h,g as f,m as P,h as p,j as E,y as k,n as w,k as c,x as u,o as N,z as K,A as Y,B as De,s as ye,c as Ve,d as Q,t as re,b as Oe,r as Ce,u as Ie,v as Ae,w as Se,p as Ue}from"../chunks/index.a6c99fb1.js";import{w as Fe}from"../chunks/singletons.36709325.js";import{p as Ge}from"../chunks/stores.e1c9a91f.js";const D={DOCUMENT:"document",TRACKING:"tracking",DISTRIBUTION:"distribution",TLP:"tlp",TITLE:"title",LANG:"lang",CSAFVERSION:"csaf_version",ID:"id",LABEL:"label",STATUS:"status",INITIALRELEASEDATE:"initial_release_date",CURRENTRELEASEDATE:"current_release_date"},I={AMBER:"AMBER",GREEN:"GREEN",RED:"RED",WHITE:"WHITE",ERROR:"Invalid TLP"},C="",H={draft:"draft",final:"final",interim:"interim",ERROR:"Invalid Status"};function He(){const e={doc:null},{subscribe:s,set:t,update:n}=Fe(e);return{subscribe:s,setDocument:d=>n(r=>(r.doc=d,r)),reset:()=>t(e)}}const ne=He();function Le(e){let s,t,n,d="TLP",r,l,o,i,a,_="Title",m,v,g,y="ID",A,V,S,J="Language",L,M,O,ie="CSAF-Version",W,Z,U,de="Published",j,$,F,ue="Last update",x,ee,G,ce="Status",z,te;return{c(){s=f("div"),t=f("dl"),n=f("dt"),n.textContent=d,r=f("dd"),l=f("span"),o=P(e[0]),a=f("dt"),a.textContent=_,m=f("dd"),v=P(e[9]),g=f("dt"),g.textContent=y,A=f("dd"),V=P(e[6]),S=f("dt"),S.textContent=J,L=f("dd"),M=P(e[8]),O=f("dt"),O.textContent=ie,W=f("dd"),Z=P(e[7]),U=f("dt"),U.textContent=de,j=f("dd"),$=P(e[5]),F=f("dt"),F.textContent=ue,x=f("dd"),ee=P(e[4]),G=f("dt"),G.textContent=ce,z=f("dd"),te=P(e[3]),this.h()},l(T){s=p(T,"DIV",{class:!0});var R=E(s);t=p(R,"DL",{});var b=E(t);n=p(b,"DT",{class:!0,"data-svelte-h":!0}),k(n)!=="svelte-ktx0ke"&&(n.textContent=d),r=p(b,"DD",{class:!0});var fe=E(r);l=p(fe,"SPAN",{class:!0});var pe=E(l);o=w(pe,e[0]),pe.forEach(h),fe.forEach(h),a=p(b,"DT",{class:!0,"data-svelte-h":!0}),k(a)!=="svelte-hf466c"&&(a.textContent=_),m=p(b,"DD",{class:!0});var he=E(m);v=w(he,e[9]),he.forEach(h),g=p(b,"DT",{class:!0,"data-svelte-h":!0}),k(g)!=="svelte-zwbns7"&&(g.textContent=y),A=p(b,"DD",{class:!0});var me=E(A);V=w(me,e[6]),me.forEach(h),S=p(b,"DT",{class:!0,"data-svelte-h":!0}),k(S)!=="svelte-1aab11o"&&(S.textContent=J),L=p(b,"DD",{class:!0});var _e=E(L);M=w(_e,e[8]),_e.forEach(h),O=p(b,"DT",{class:!0,"data-svelte-h":!0}),k(O)!=="svelte-1s0hun2"&&(O.textContent=ie),W=p(b,"DD",{class:!0});var ve=E(W);Z=w(ve,e[7]),ve.forEach(h),U=p(b,"DT",{class:!0,"data-svelte-h":!0}),k(U)!=="svelte-4ntl4g"&&(U.textContent=de),j=p(b,"DD",{class:!0});var ge=E(j);$=w(ge,e[5]),ge.forEach(h),F=p(b,"DT",{class:!0,"data-svelte-h":!0}),k(F)!=="svelte-tmity1"&&(F.textContent=ue),x=p(b,"DD",{class:!0});var Ee=E(x);ee=w(Ee,e[4]),Ee.forEach(h),G=p(b,"DT",{class:!0,"data-svelte-h":!0}),k(G)!=="svelte-1e9eis"&&(G.textContent=ce),z=p(b,"DD",{class:!0});var be=E(z);te=w(be,e[3]),be.forEach(h),b.forEach(h),R.forEach(h),this.h()},h(){c(n,"class","svelte-1u358bg"),c(l,"class",i=Te(e[2])+" svelte-1u358bg"),c(r,"class","svelte-1u358bg"),c(a,"class","svelte-1u358bg"),c(m,"class","svelte-1u358bg"),c(g,"class","svelte-1u358bg"),c(A,"class","svelte-1u358bg"),c(S,"class","svelte-1u358bg"),c(L,"class","svelte-1u358bg"),c(O,"class","svelte-1u358bg"),c(W,"class","svelte-1u358bg"),c(U,"class","svelte-1u358bg"),c(j,"class","svelte-1u358bg"),c(F,"class","svelte-1u358bg"),c(x,"class","svelte-1u358bg"),c(G,"class","svelte-1u358bg"),c(z,"class","svelte-1u358bg"),c(s,"class","documentdata")},m(T,R){B(T,s,R),u(s,t),u(t,n),u(t,r),u(r,l),u(l,o),u(t,a),u(t,m),u(m,v),u(t,g),u(t,A),u(A,V),u(t,S),u(t,L),u(L,M),u(t,O),u(t,W),u(W,Z),u(t,U),u(t,j),u(j,$),u(t,F),u(t,x),u(x,ee),u(t,G),u(t,z),u(z,te)},p(T,R){R&1&&N(o,T[0]),R&4&&i!==(i=Te(T[2])+" svelte-1u358bg")&&c(l,"class",i),R&512&&N(v,T[9]),R&64&&N(V,T[6]),R&256&&N(M,T[8]),R&128&&N(Z,T[7]),R&32&&N($,T[5]),R&16&&N(ee,T[4]),R&8&&N(te,T[3])},d(T){T&&h(s)}}}function We(e){let s,t=e[1].doc&&Le(e);return{c(){t&&t.c(),s=Re()},l(n){t&&t.l(n),s=Re()},m(n,d){t&&t.m(n,d),B(n,s,d)},p(n,[d]){n[1].doc?t?t.p(n,d):(t=Le(n),t.c(),t.m(s.parentNode,s)):t&&(t.d(1),t=null)},i:se,o:se,d(n){n&&h(s),t&&t.d(n)}}}function je(e,s,t){let n,d,r,l,o,i,a,_,m;we(e,ne,g=>t(1,m=g));let v="";return e.$$.update=()=>{var g,y,A,V,S,J,L,M;e.$$.dirty&2&&t(9,n=(g=m.doc)==null?void 0:g.title),e.$$.dirty&2&&t(8,d=(y=m.doc)==null?void 0:y.lang),e.$$.dirty&2&&t(7,r=(A=m.doc)==null?void 0:A.csafVersion),e.$$.dirty&2&&t(0,l=(V=m.doc)==null?void 0:V.tlp),e.$$.dirty&1&&(l===I.WHITE?t(2,v="tlpclear"):l===I.RED?t(2,v="tlred"):l===I.AMBER?t(2,v="tlamber"):l===I.GREEN&&t(2,v="tlgreen")),e.$$.dirty&2&&t(6,o=(S=m.doc)==null?void 0:S.id),e.$$.dirty&2&&t(5,i=(J=m.doc)==null?void 0:J.published),e.$$.dirty&2&&t(4,a=(L=m.doc)==null?void 0:L.lastUpdate),e.$$.dirty&2&&t(3,_=(M=m.doc)==null?void 0:M.status)},[l,m,v,_,a,i,o,r,d,n]}class xe extends ae{constructor(s){super(),oe(this,s,je,We,le,{})}}const q=e=>e.hasOwnProperty(D.DOCUMENT),X=e=>q(e)&&e.document[D.TRACKING],Be=e=>q(e)&&e.document[D.DISTRIBUTION],Me=e=>Be(e)&&e.document.distribution[D.TLP]&&e.document.distribution[D.TLP][D.LABEL],ze=e=>q(e)&&e.document[D.TITLE]||C,Ke=e=>q(e)&&e.document[D.LANG]||C,qe=e=>q(e)&&e.document[D.CSAFVERSION]||C,Je=e=>X(e)&&e.document.tracking[D.ID]||C,Ye=e=>{if(!Me(e))return C;switch(e.document.distribution.tlp[D.LABEL]){case I.AMBER:return I.AMBER;case I.GREEN:return I.AMBER;case I.WHITE:return I.WHITE;case I.RED:return I.RED;default:return I.ERROR}},Qe=e=>{if(!X(e))return C;switch(e.document.tracking[D.STATUS]){case H.draft:return H.draft;case H.final:return H.final;case H.interim:return H.interim;default:return H.ERROR}},Xe=e=>X(e)&&e.document.tracking[D.INITIALRELEASEDATE]||C,Ze=e=>X(e)&&e.document.tracking[D.CURRENTRELEASEDATE]||C,$e=e=>({title:ze(e),lang:Ke(e),csafVersion:qe(e),tlp:Ye(e),id:Je(e),status:Qe(e),published:Xe(e),lastUpdate:Ze(e),isDocPresent:q(e),isTrackingPresent:X(e),isDistributionPresent:Be(e),isTLPPresent:Me(e)});function Pe(e){let s;return{c(){s=f("i"),this.h()},l(t){s=p(t,"I",{class:!0}),E(s).forEach(h),this.h()},h(){c(s,"class","bx bx-error")},m(t,n){B(t,s,n)},d(t){t&&h(s)}}}function et(e){let s,t,n,d,r=e[3]&&Pe();return{c(){s=f("div"),r&&r.c(),t=P(e[2]),this.h()},l(l){s=p(l,"DIV",{class:!0});var o=E(s);r&&r.l(o),t=w(o,e[2]),o.forEach(h),this.h()},h(){c(s,"class","droparea svelte-n060w0"),K(s,"hover",e[1]),K(s,"bg-error",e[0]==!1),K(s,"bg-success",e[0]==!0)},m(l,o){B(l,s,o),r&&r.m(s,null),u(s,t),n||(d=[Y(s,"dragover",De(e[5])),Y(s,"dragleave",e[6]),Y(s,"drop",De(e[4]))],n=!0)},p(l,[o]){l[3]?r||(r=Pe(),r.c(),r.m(s,t)):r&&(r.d(1),r=null),o&4&&N(t,l[2]),o&2&&K(s,"hover",l[1]),o&1&&K(s,"bg-error",l[0]==!1),o&1&&K(s,"bg-success",l[0]==!0)},i:se,o:se,d(l){l&&h(s),r&&r.d(),n=!1,Ne(d)}}}function tt(e,s,t){let n,d=!1,r=null,l="Drop your CSAF-file here";const o=m=>{if(m.dataTransfer){const v=m.dataTransfer.files[0];v.type=="application/json"?(t(0,r=!0),t(2,l=`Displaying file "${v.name}".`),i(v)):(t(2,l=`File "${v.name}" has an invalid format.`),t(0,r=!1),ne.setDocument(null))}},i=m=>{const v=new FileReader;let g={};v.onload=y=>{if(y.target){try{g=JSON.parse(y.target.result)}catch{}const A=$e(g);ne.setDocument(A)}},v.readAsText(m)},a=()=>{t(1,d=!0)},_=()=>{t(1,d=!1)};return e.$$.update=()=>{e.$$.dirty&1&&t(3,n=r===!1)},[r,d,l,n,o,a,_]}class st extends ae{constructor(s){super(),oe(this,s,tt,et,le,{})}}function ke(e){let s,t,n,d,r,l,o,i;return n=new st({}),o=new xe({}),{c(){s=f("div"),t=f("div"),Ce(n.$$.fragment),d=ye(),r=f("div"),l=f("div"),Ce(o.$$.fragment),this.h()},l(a){s=p(a,"DIV",{class:!0});var _=E(s);t=p(_,"DIV",{class:!0});var m=E(t);Ie(n.$$.fragment,m),m.forEach(h),_.forEach(h),d=Ve(a),r=p(a,"DIV",{class:!0});var v=E(r);l=p(v,"DIV",{class:!0});var g=E(l);Ie(o.$$.fragment,g),g.forEach(h),v.forEach(h),this.h()},h(){c(t,"class","col"),c(s,"class","row"),c(l,"class","col"),c(r,"class","row")},m(a,_){B(a,s,_),u(s,t),Ae(n,t,null),B(a,d,_),B(a,r,_),u(r,l),Ae(o,l,null),i=!0},i(a){i||(Q(n.$$.fragment,a),Q(o.$$.fragment,a),i=!0)},o(a){re(n.$$.fragment,a),re(o.$$.fragment,a),i=!1},d(a){a&&(h(s),h(d),h(r)),Se(n),Se(o)}}}function rt(e){let s,t,n="CSAF Webview+",d,r,l,o,i=e[0]&&ke();return{c(){s=f("div"),t=f("h1"),t.textContent=n,d=ye(),i&&i.c(),this.h()},l(a){s=p(a,"DIV",{class:!0});var _=E(s);t=p(_,"H1",{role:!0,class:!0,"data-svelte-h":!0}),k(t)!=="svelte-1obxzj0"&&(t.textContent=n),d=Ve(_),i&&i.l(_),_.forEach(h),this.h()},h(){c(t,"role","heading"),c(t,"class","text-center"),c(s,"class","container")},m(a,_){B(a,s,_),u(s,t),u(s,d),i&&i.m(s,null),r=!0,l||(o=[Y(window,"dragover",e[1]),Y(window,"drop",e[1])],l=!0)},p(a,[_]){a[0]?i?_&1&&Q(i,1):(i=ke(),i.c(),Q(i,1),i.m(s,null)):i&&(Ue(),re(i,1,1,()=>{i=null}),Oe())},i(a){r||(Q(i),r=!0)},o(a){re(i),r=!1},d(a){a&&h(s),i&&i.d(),l=!1,Ne(o)}}}function nt(e,s,t){let n,d;we(e,Ge,o=>t(2,d=o));const r=d.url.searchParams.get("ref"),l=o=>{o.preventDefault()};return t(0,n=!r),[n,l]}class dt extends ae{constructor(s){super(),oe(this,s,nt,rt,le,{})}}export{dt as component};
