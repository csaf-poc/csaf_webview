import{s as le,n as ee,e as we,f as be,r as Ne}from"../chunks/scheduler.8b5db029.js";import{S as ae,i as oe,e as Te,a as y,f as c,g as p,m as w,h,j as g,y as B,n as N,k as v,x as d,o as M,z as K,A as Y,B as De,s as se,c as re,d as x,t as te,b as Be,r as Re,u as Ce,v as Ie,w as Ae,p as Me}from"../chunks/index.a6c99fb1.js";import{w as Oe}from"../chunks/singletons.c2bdda46.js";import{p as Ue}from"../chunks/stores.f16ae7a9.js";const S={DOCUMENT:"document",TRACKING:"tracking",DISTRIBUTION:"distribution",TLP:"tlp",TITLE:"title",LANG:"lang",CSAFVERSION:"csaf_version",ID:"id",LABEL:"label",STATUS:"status",INITIALRELEASEDATE:"initial_release_date",CURRENTRELEASEDATE:"current_release_date"},P={AMBER:"AMBER",GREEN:"GREEN",RED:"RED",WHITE:"WHITE",ERROR:"Invalid TLP"},L="",O={draft:"draft",final:"final",interim:"interim",ERROR:"Invalid Status"};function Fe(){const e={doc:null},{subscribe:s,set:t,update:r}=Oe(e);return{subscribe:s,setDocument:o=>r(n=>(n.doc=o,n)),reset:()=>t(e)}}const ne=Fe();function Se(e){var ce;let s,t,r,o="TLP",n,l,i,m,u,b="Title",f,_,a,D="ID",E,k,I,J="Language",V,U,F,ie="CSAF-Version",W,X,G,de="Published",j,Z,H,ue="Last update",z,$,C=((ce=e[1].doc)==null?void 0:ce.status)!==O.final&&Le(e);return{c(){s=p("div"),t=p("dl"),r=p("dt"),r.textContent=o,n=p("dd"),l=p("span"),i=w(e[0]),u=p("dt"),u.textContent=b,f=p("dd"),_=w(e[9]),a=p("dt"),a.textContent=D,E=p("dd"),k=w(e[6]),I=p("dt"),I.textContent=J,V=p("dd"),U=w(e[8]),F=p("dt"),F.textContent=ie,W=p("dd"),X=w(e[7]),G=p("dt"),G.textContent=de,j=p("dd"),Z=w(e[5]),H=p("dt"),H.textContent=ue,z=p("dd"),$=w(e[4]),C&&C.c(),this.h()},l(R){s=h(R,"DIV",{class:!0});var A=g(s);t=h(A,"DL",{});var T=g(t);r=h(T,"DT",{class:!0,"data-svelte-h":!0}),B(r)!=="svelte-ktx0ke"&&(r.textContent=o),n=h(T,"DD",{class:!0});var fe=g(n);l=h(fe,"SPAN",{class:!0});var pe=g(l);i=N(pe,e[0]),pe.forEach(c),fe.forEach(c),u=h(T,"DT",{class:!0,"data-svelte-h":!0}),B(u)!=="svelte-hf466c"&&(u.textContent=b),f=h(T,"DD",{class:!0});var he=g(f);_=N(he,e[9]),he.forEach(c),a=h(T,"DT",{class:!0,"data-svelte-h":!0}),B(a)!=="svelte-zwbns7"&&(a.textContent=D),E=h(T,"DD",{class:!0});var ve=g(E);k=N(ve,e[6]),ve.forEach(c),I=h(T,"DT",{class:!0,"data-svelte-h":!0}),B(I)!=="svelte-1aab11o"&&(I.textContent=J),V=h(T,"DD",{class:!0});var _e=g(V);U=N(_e,e[8]),_e.forEach(c),F=h(T,"DT",{class:!0,"data-svelte-h":!0}),B(F)!=="svelte-1s0hun2"&&(F.textContent=ie),W=h(T,"DD",{class:!0});var me=g(W);X=N(me,e[7]),me.forEach(c),G=h(T,"DT",{class:!0,"data-svelte-h":!0}),B(G)!=="svelte-4ntl4g"&&(G.textContent=de),j=h(T,"DD",{class:!0});var Ee=g(j);Z=N(Ee,e[5]),Ee.forEach(c),H=h(T,"DT",{class:!0,"data-svelte-h":!0}),B(H)!=="svelte-tmity1"&&(H.textContent=ue),z=h(T,"DD",{class:!0});var ge=g(z);$=N(ge,e[4]),ge.forEach(c),C&&C.l(T),T.forEach(c),A.forEach(c),this.h()},h(){v(r,"class","svelte-1u358bg"),v(l,"class",m=be(e[2])+" svelte-1u358bg"),v(n,"class","svelte-1u358bg"),v(u,"class","svelte-1u358bg"),v(f,"class","svelte-1u358bg"),v(a,"class","svelte-1u358bg"),v(E,"class","svelte-1u358bg"),v(I,"class","svelte-1u358bg"),v(V,"class","svelte-1u358bg"),v(F,"class","svelte-1u358bg"),v(W,"class","svelte-1u358bg"),v(G,"class","svelte-1u358bg"),v(j,"class","svelte-1u358bg"),v(H,"class","svelte-1u358bg"),v(z,"class","svelte-1u358bg"),v(s,"class","documentdata")},m(R,A){y(R,s,A),d(s,t),d(t,r),d(t,n),d(n,l),d(l,i),d(t,u),d(t,f),d(f,_),d(t,a),d(t,E),d(E,k),d(t,I),d(t,V),d(V,U),d(t,F),d(t,W),d(W,X),d(t,G),d(t,j),d(j,Z),d(t,H),d(t,z),d(z,$),C&&C.m(t,null)},p(R,A){var T;A&1&&M(i,R[0]),A&4&&m!==(m=be(R[2])+" svelte-1u358bg")&&v(l,"class",m),A&512&&M(_,R[9]),A&64&&M(k,R[6]),A&256&&M(U,R[8]),A&128&&M(X,R[7]),A&32&&M(Z,R[5]),A&16&&M($,R[4]),((T=R[1].doc)==null?void 0:T.status)!==O.final?C?C.p(R,A):(C=Le(R),C.c(),C.m(t,null)):C&&(C.d(1),C=null)},d(R){R&&c(s),C&&C.d()}}}function Le(e){let s,t="Status",r,o;return{c(){s=p("dt"),s.textContent=t,r=p("dd"),o=w(e[3]),this.h()},l(n){s=h(n,"DT",{class:!0,"data-svelte-h":!0}),B(s)!=="svelte-1e9eis"&&(s.textContent=t),r=h(n,"DD",{class:!0});var l=g(r);o=N(l,e[3]),l.forEach(c),this.h()},h(){v(s,"class","svelte-1u358bg"),v(r,"class","svelte-1u358bg")},m(n,l){y(n,s,l),y(n,r,l),d(r,o)},p(n,l){l&8&&M(o,n[3])},d(n){n&&(c(s),c(r))}}}function Ge(e){let s,t=e[1].doc&&Se(e);return{c(){t&&t.c(),s=Te()},l(r){t&&t.l(r),s=Te()},m(r,o){t&&t.m(r,o),y(r,s,o)},p(r,[o]){r[1].doc?t?t.p(r,o):(t=Se(r),t.c(),t.m(s.parentNode,s)):t&&(t.d(1),t=null)},i:ee,o:ee,d(r){r&&c(s),t&&t.d(r)}}}function He(e,s,t){let r,o,n,l,i,m,u,b,f;we(e,ne,a=>t(1,f=a));let _="";return e.$$.update=()=>{var a,D,E,k,I,J,V,U;e.$$.dirty&2&&t(9,r=(a=f.doc)==null?void 0:a.title),e.$$.dirty&2&&t(8,o=(D=f.doc)==null?void 0:D.lang),e.$$.dirty&2&&t(7,n=(E=f.doc)==null?void 0:E.csafVersion),e.$$.dirty&2&&t(0,l=(k=f.doc)==null?void 0:k.tlp),e.$$.dirty&1&&(l===P.WHITE?t(2,_="tlpclear"):l===P.RED?t(2,_="tlred"):l===P.AMBER?t(2,_="tlamber"):l===P.GREEN&&t(2,_="tlgreen")),e.$$.dirty&2&&t(6,i=(I=f.doc)==null?void 0:I.id),e.$$.dirty&2&&t(5,m=(J=f.doc)==null?void 0:J.published),e.$$.dirty&2&&t(4,u=(V=f.doc)==null?void 0:V.lastUpdate),e.$$.dirty&2&&t(3,b=(U=f.doc)==null?void 0:U.status)},[l,f,_,b,u,m,i,n,o,r]}class We extends ae{constructor(s){super(),oe(this,s,He,Ge,le,{})}}const q=e=>e.hasOwnProperty(S.DOCUMENT),Q=e=>q(e)&&e.document[S.TRACKING],ye=e=>q(e)&&e.document[S.DISTRIBUTION],Ve=e=>ye(e)&&e.document.distribution[S.TLP]&&e.document.distribution[S.TLP][S.LABEL],je=e=>q(e)&&e.document[S.TITLE]||L,ze=e=>q(e)&&e.document[S.LANG]||L,Ke=e=>q(e)&&e.document[S.CSAFVERSION]||L,qe=e=>Q(e)&&e.document.tracking[S.ID]||L,Je=e=>{if(!Ve(e))return L;switch(e.document.distribution.tlp[S.LABEL]){case P.AMBER:return P.AMBER;case P.GREEN:return P.AMBER;case P.WHITE:return P.WHITE;case P.RED:return P.RED;default:return P.ERROR}},Ye=e=>{if(!Q(e))return L;switch(e.document.tracking[S.STATUS]){case O.draft:return O.draft;case O.final:return O.final;case O.interim:return O.interim;default:return O.ERROR}},xe=e=>Q(e)&&e.document.tracking[S.INITIALRELEASEDATE]||L,Qe=e=>Q(e)&&e.document.tracking[S.CURRENTRELEASEDATE]||L,Xe=e=>({title:je(e),lang:ze(e),csafVersion:Ke(e),tlp:Je(e),id:qe(e),status:Ye(e),published:xe(e),lastUpdate:Qe(e),isDocPresent:q(e),isTrackingPresent:Q(e),isDistributionPresent:ye(e),isTLPPresent:Ve(e)});function ke(e){let s;return{c(){s=p("i"),this.h()},l(t){s=h(t,"I",{class:!0}),g(s).forEach(c),this.h()},h(){v(s,"class","bx bx-error")},m(t,r){y(t,s,r)},d(t){t&&c(s)}}}function Ze(e){let s,t,r,o,n=e[3]&&ke();return{c(){s=p("div"),n&&n.c(),t=w(e[2]),this.h()},l(l){s=h(l,"DIV",{class:!0});var i=g(s);n&&n.l(i),t=N(i,e[2]),i.forEach(c),this.h()},h(){v(s,"class","droparea svelte-n060w0"),K(s,"hover",e[1]),K(s,"bg-error",e[0]==!1),K(s,"bg-success",e[0]==!0)},m(l,i){y(l,s,i),n&&n.m(s,null),d(s,t),r||(o=[Y(s,"dragover",De(e[5])),Y(s,"dragleave",e[6]),Y(s,"drop",De(e[4]))],r=!0)},p(l,[i]){l[3]?n||(n=ke(),n.c(),n.m(s,t)):n&&(n.d(1),n=null),i&4&&M(t,l[2]),i&2&&K(s,"hover",l[1]),i&1&&K(s,"bg-error",l[0]==!1),i&1&&K(s,"bg-success",l[0]==!0)},i:ee,o:ee,d(l){l&&c(s),n&&n.d(),r=!1,Ne(o)}}}function $e(e,s,t){let r,o=!1,n=null,l="Drop your CSAF-file here";const i=f=>{if(f.dataTransfer){const _=f.dataTransfer.files[0];_.type=="application/json"?(t(0,n=!0),t(2,l=`Displaying file "${_.name}".`),m(_)):(t(2,l=`File "${_.name}" has an invalid format.`),t(0,n=!1),ne.setDocument(null))}},m=f=>{const _=new FileReader;let a={};_.onload=D=>{if(D.target){try{a=JSON.parse(D.target.result)}catch{}const E=Xe(a);ne.setDocument(E)}},_.readAsText(f)},u=()=>{t(1,o=!0)},b=()=>{t(1,o=!1)};return e.$$.update=()=>{e.$$.dirty&1&&t(3,r=n===!1)},[n,o,l,r,i,u,b]}class et extends ae{constructor(s){super(),oe(this,s,$e,Ze,le,{})}}function Pe(e){let s,t,r,o,n,l,i,m;return r=new et({}),i=new We({}),{c(){s=p("div"),t=p("div"),Re(r.$$.fragment),o=se(),n=p("div"),l=p("div"),Re(i.$$.fragment),this.h()},l(u){s=h(u,"DIV",{class:!0});var b=g(s);t=h(b,"DIV",{class:!0});var f=g(t);Ce(r.$$.fragment,f),f.forEach(c),b.forEach(c),o=re(u),n=h(u,"DIV",{class:!0});var _=g(n);l=h(_,"DIV",{class:!0});var a=g(l);Ce(i.$$.fragment,a),a.forEach(c),_.forEach(c),this.h()},h(){v(t,"class","col"),v(s,"class","row"),v(l,"class","col"),v(n,"class","row")},m(u,b){y(u,s,b),d(s,t),Ie(r,t,null),y(u,o,b),y(u,n,b),d(n,l),Ie(i,l,null),m=!0},i(u){m||(x(r.$$.fragment,u),x(i.$$.fragment,u),m=!0)},o(u){te(r.$$.fragment,u),te(i.$$.fragment,u),m=!1},d(u){u&&(c(s),c(o),c(n)),Ae(r),Ae(i)}}}function tt(e){let s,t,r,o="CSAF Webview+",n,l,i,m,u,b,f,_,a=e[0]&&Pe();return{c(){s=p("div"),t=p("div"),r=p("h1"),r.textContent=o,n=se(),l=p("h4"),i=w("v. "),m=w(e[1]),u=se(),a&&a.c(),this.h()},l(D){s=h(D,"DIV",{class:!0});var E=g(s);t=h(E,"DIV",{class:!0});var k=g(t);r=h(k,"H1",{role:!0,class:!0,"data-svelte-h":!0}),B(r)!=="svelte-1obxzj0"&&(r.textContent=o),n=re(k),l=h(k,"H4",{});var I=g(l);i=N(I,"v. "),m=N(I,e[1]),I.forEach(c),k.forEach(c),u=re(E),a&&a.l(E),E.forEach(c),this.h()},h(){v(r,"role","heading"),v(r,"class","text-center"),v(t,"class","header svelte-t1xvt1"),v(s,"class","container")},m(D,E){y(D,s,E),d(s,t),d(t,r),d(t,n),d(t,l),d(l,i),d(l,m),d(s,u),a&&a.m(s,null),b=!0,f||(_=[Y(window,"dragover",e[2]),Y(window,"drop",e[2])],f=!0)},p(D,[E]){D[0]?a?E&1&&x(a,1):(a=Pe(),a.c(),x(a,1),a.m(s,null)):a&&(Me(),te(a,1,1,()=>{a=null}),Be())},i(D){b||(x(a),b=!0)},o(D){te(a),b=!1},d(D){D&&c(s),a&&a.d(),f=!1,Ne(_)}}}function st(e,s,t){let r,o;we(e,Ue,m=>t(3,o=m));const n="0.0.1",l=o.url.searchParams.get("ref"),i=m=>{m.preventDefault()};return t(0,r=!l),[r,n,i]}class ot extends ae{constructor(s){super(),oe(this,s,st,tt,le,{})}}export{ot as component};
